[TOC]

# Class文件结构

## 1 概述

### 1.1 字节码文件的跨平台性

![image-20230211100125766](中篇-JVM字节码详解.assets/image-20230211100125766.png)

![image-20230211100721800](中篇-JVM字节码详解.assets/image-20230211100721800.png)

![image-20230211100916195](中篇-JVM字节码详解.assets/image-20230211100916195.png)

### 1.2 Java的前端编译器

![image-20230211101441893](中篇-JVM字节码详解.assets/image-20230211101441893.png)

![image-20230211101404613](中篇-JVM字节码详解.assets/image-20230211101404613.png)

## 2 虚拟机的基石：Class文件

![image-20230211190428759](中篇-JVM字节码详解.assets/image-20230211190428759.png)

![image-20230212102304711](中篇-JVM字节码详解.assets/image-20230212102304711.png)

![image-20230212102245838](中篇-JVM字节码详解.assets/image-20230212102245838.png)

## 3 Class文件结构

![image-20230212103020682](中篇-JVM字节码详解.assets/image-20230212103020682.png)

![image-20230212104443040](中篇-JVM字节码详解.assets/image-20230212104443040.png)

![image-20230212104630492](中篇-JVM字节码详解.assets/image-20230212104630492.png)

![image-20230212105034105](中篇-JVM字节码详解.assets/image-20230212105034105.png)

```java
//讲解的代码
package com.atguigu.java1;
    
public class Demo{
    private int num = 1;
    public int add(){
        num = num + 2;
        return num;
    }
}
```

### 3.1 魔数

![image-20230212110010541](中篇-JVM字节码详解.assets/image-20230212110010541.png)

### 3.2 版本号

![image-20230212110603084](中篇-JVM字节码详解.assets/image-20230212110603084.png)

![image-20230212110754921](中篇-JVM字节码详解.assets/image-20230212110754921.png)

### 3.3 常量池：存放所有常量

![image-20230212111249025](中篇-JVM字节码详解.assets/image-20230212111249025.png)

![image-20230212111651911](中篇-JVM字节码详解.assets/image-20230212111651911.png)

#### 3.3.1 常量池计数器

![image-20230212130811974](中篇-JVM字节码详解.assets/image-20230212130811974.png)

#### 3.3.2 常量池表

![image-20230312163507568](中篇-JVM字节码详解.assets/image-20230312163507568.png)

![image-20230312163750947](中篇-JVM字节码详解.assets/image-20230312163750947.png)

**3.3.2.1 字面量和符号引用**

![image-20230312163904889](中篇-JVM字节码详解.assets/image-20230312163904889.png)

![image-20230312164250886](中篇-JVM字节码详解.assets/image-20230312164250886.png)

![image-20230312164621863](中篇-JVM字节码详解.assets/image-20230312164621863.png)

![image-20230312165446679](中篇-JVM字节码详解.assets/image-20230312165446679.png)

![image-20230312165521424](中篇-JVM字节码详解.assets/image-20230312165521424.png)

![image-20230312183614787](中篇-JVM字节码详解.assets/image-20230312183614787.png)

![image-20230312183737209](中篇-JVM字节码详解.assets/image-20230312183737209.png)

### 3.4 访问标识

![image-20230312183912225](中篇-JVM字节码详解.assets/image-20230312183912225.png)

![image-20230312184442757](中篇-JVM字节码详解.assets/image-20230312184442757.png)

### 3.5 类索引，父类索引，接口索引集合

![image-20230312210815561](中篇-JVM字节码详解.assets/image-20230312210815561.png)

![image-20230312210856548](中篇-JVM字节码详解.assets/image-20230312210856548.png)

### 3.6 字段表集合

![image-20230313194207213](中篇-JVM字节码详解.assets/image-20230313194207213.png)

![image-20230313194636378](中篇-JVM字节码详解.assets/image-20230313194636378.png)

![image-20230313194840638](中篇-JVM字节码详解.assets/image-20230313194840638.png)

![image-20230313194956526](中篇-JVM字节码详解.assets/image-20230313194956526.png)

![image-20230313195154649](中篇-JVM字节码详解.assets/image-20230313195154649.png)

![image-20230313195228680](中篇-JVM字节码详解.assets/image-20230313195228680.png)

![image-20230313195458588](中篇-JVM字节码详解.assets/image-20230313195458588.png)

### 3.7 方法表集合

![image-20230313195838643](中篇-JVM字节码详解.assets/image-20230313195838643.png)

![image-20230315202329615](中篇-JVM字节码详解.assets/image-20230315202329615.png)

![image-20230315202859401](中篇-JVM字节码详解.assets/image-20230315202859401.png)

### 3.8 属性表集合

![image-20230315203040638](中篇-JVM字节码详解.assets/image-20230315203040638.png)

![image-20230315203345284](中篇-JVM字节码详解.assets/image-20230315203345284.png)

![image-20230315203516625](中篇-JVM字节码详解.assets/image-20230315203516625.png)

![image-20230315203625909](中篇-JVM字节码详解.assets/image-20230315203625909.png)

![image-20230315203647147](中篇-JVM字节码详解.assets/image-20230315203647147.png)

![image-20230315210820686](中篇-JVM字节码详解.assets/image-20230315210820686.png)

## 4 javap指令解析Class文件

### 4.1 javac -g操作

![image-20230316202201806](中篇-JVM字节码详解.assets/image-20230316202201806.png)

### 4.2 javap的用法

![image-20230316203040677](中篇-JVM字节码详解.assets/image-20230316203040677.png)

### 4.3 总结

![image-20230318203759829](中篇-JVM字节码详解.assets/image-20230318203759829.png)

# 字节码指令集与解析

## 1 字节码指令集的概述

![image-20230318204816043](中篇-JVM字节码详解.assets/image-20230318204816043.png)

![image-20230318211003707](中篇-JVM字节码详解.assets/image-20230318211003707.png)

![image-20230318211127252](中篇-JVM字节码详解.assets/image-20230318211127252.png)

![image-20230318211656547](中篇-JVM字节码详解.assets/image-20230318211656547.png)

## 2 加载与存储指令

![image-20230318212050456](中篇-JVM字节码详解.assets/image-20230318212050456.png)

![image-20230320205335762](中篇-JVM字节码详解.assets/image-20230320205335762.png)

![image-20230320205627410](中篇-JVM字节码详解.assets/image-20230320205627410.png)

![image-20230320205655133](中篇-JVM字节码详解.assets/image-20230320205655133.png)

### 2.1 局部变量表压栈指令

![image-20230320205923706](中篇-JVM字节码详解.assets/image-20230320205923706.png)

### 2.2 常量入栈指令

![image-20230320210555824](中篇-JVM字节码详解.assets/image-20230320210555824.png)

![image-20230320211723579](中篇-JVM字节码详解.assets/image-20230320211723579.png)

### 2.3 出栈装入局部变量表指令

![image-20230320211757221](中篇-JVM字节码详解.assets/image-20230320211757221.png)

## 3 算术指令

![image-20230321200808864](中篇-JVM字节码详解.assets/image-20230321200808864.png)

![image-20230321200934415](中篇-JVM字节码详解.assets/image-20230321200934415.png)

![image-20230321201318886](中篇-JVM字节码详解.assets/image-20230321201318886.png)

![image-20230321204039425](中篇-JVM字节码详解.assets/image-20230321204039425.png)

## 4类型转换指令

![image-20230321204130706](中篇-JVM字节码详解.assets/image-20230321204130706.png)

### 4.1 宽化类型转换

![image-20230321204325289](中篇-JVM字节码详解.assets/image-20230321204325289.png)

![image-20230321223838816](中篇-JVM字节码详解.assets/image-20230321223838816.png)

### 4.2 窄化类型转换

![image-20230321224004725](中篇-JVM字节码详解.assets/image-20230321224004725.png)

![image-20230321225531123](中篇-JVM字节码详解.assets/image-20230321225531123.png)

## 5 对象的创建和访问指令

![image-20230321225655673](中篇-JVM字节码详解.assets/image-20230321225655673.png)

### 5.1 创建指令

![image-20230321225928577](中篇-JVM字节码详解.assets/image-20230321225928577.png)

### 5.2 字段访问指令

![image-20230322202617564](中篇-JVM字节码详解.assets/image-20230322202617564.png)

### 5.3 数组操作指令

![image-20230322222618396](中篇-JVM字节码详解.assets/image-20230322222618396.png)

![image-20230322222848298](中篇-JVM字节码详解.assets/image-20230322222848298.png)

### 5.4 类型检查指令

![image-20230322223549040](中篇-JVM字节码详解.assets/image-20230322223549040.png)

## 6 方法调用与返回指令

### 6.1 方法调用指令

![image-20230322224047130](中篇-JVM字节码详解.assets/image-20230322224047130.png)

### 6.2 方法返回指令

![image-20230322225247766](中篇-JVM字节码详解.assets/image-20230322225247766.png)

## 7 操作数栈管理指令

![image-20230323193819324](中篇-JVM字节码详解.assets/image-20230323193819324.png)

![image-20230323193953990](中篇-JVM字节码详解.assets/image-20230323193953990.png)

## 8 控制转移指令

![image-20230323195206624](中篇-JVM字节码详解.assets/image-20230323195206624.png)

### 8.1 条件跳转指令

![image-20230323195931535](中篇-JVM字节码详解.assets/image-20230323195931535.png)

![image-20230323200431201](中篇-JVM字节码详解.assets/image-20230323200431201.png)

### 8.2 比较条件跳转指令

![image-20230323205704198](中篇-JVM字节码详解.assets/image-20230323205704198.png)

### 8.3 多条件分支跳转指令

![image-20230323210229361](中篇-JVM字节码详解.assets/image-20230323210229361.png)

![image-20230323210253207](中篇-JVM字节码详解.assets/image-20230323210253207.png)

![image-20230323210319299](中篇-JVM字节码详解.assets/image-20230323210319299.png)

### 8.4 无条件跳转指令

![image-20230323214013878](中篇-JVM字节码详解.assets/image-20230323214013878.png)

## 9 异常处理指令

### 9.1 抛出异常指令

![image-20230323214712625](中篇-JVM字节码详解.assets/image-20230323214712625.png)

### 9.2 异常处理与异常表

![image-20230323214811656](中篇-JVM字节码详解.assets/image-20230323214811656.png)

## 10 同步控制指令

Java虚拟机支持两种同步结构：==方法级的同步==和==方法内部一段指令序列的同步==，这两种同步都是使用monitor来支持的。

### 10.1 方法级的同步

![image-20230324220518694](中篇-JVM字节码详解.assets/image-20230324220518694.png)

![image-20230324220938134](中篇-JVM字节码详解.assets/image-20230324220938134.png)

### 10.2 同步代码块

![image-20230324221102764](中篇-JVM字节码详解.assets/image-20230324221102764.png)

# 类的加载过程（类的生命周期）详解

## 1 概述

![image-20230324222920786](中篇-JVM字节码详解.assets/image-20230324222920786.png)

![image-20230324223028119](中篇-JVM字节码详解.assets/image-20230324223028119.png)









# Refrence

官网地址:https://docs.oracle.com/javase/specs/jvms/se8/html/index.html