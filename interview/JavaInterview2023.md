# 多线程的使用场景和注意事项

## 使用场景

1. cpu密集型任务，主要是做并行计算。
2. io密集型任务，主要是异步任务处理。
3. 处理高并发的请求。
4. 定时任务和后台任务。

## 注意事项

1. 对于唯一性资源，保证竞争的条件。
2. 注意多线程共享变量的可见性。
3. 预防死锁。
4. 性能监控和调试。

# 多线程优化的点

1. 对于线程池：
   - 配置合理的参数
   - 对于线程池进行性能优化和动态调整
2. 对于锁：
   - 保证锁的粒度
   - 采用读写锁
   - 通过CAS等无锁的操作保证数据一致性
3. 内存和缓存：避免伪共享、使用缓存友好数据结构。
4. 任务分解： 合理的拆分任务，批量处理任务。
5. 对于io密集型操作：可以使用nio等异步io，减少阻塞时间。
6. 实时监控、动态调整。

# 线程池参数以及含义

1. corePoolSize - 核心线程数
2. maximumPoolSize  - 最大线程数
3. keepAliveTime - 线程空闲存活时间
4. unit - 存活时间单位
5. workQueue - 工作队列（阻塞列）
6. threadFactory - 线程工厂
7. handler - 拒绝策略

# java 热加载的方式

1. 基于Java Agent实现字节码替换。
2. 自定义类加载器方案 - 通过自定义ClassLoader实现热部署。

# JVM 内存模型

# AOP应用场景

| 场景         | 核心价值                   | 常用注解/实现                  |
| :----------- | :------------------------- | :----------------------------- |
| **日志记录** | 统一日志格式，无侵入式日志 | `@Around`, `@Before`, `@After` |
| **事务管理** | 声明式事务，简化代码       | `@Transactional`               |
| **性能监控** | 方法执行时间，调用统计     | `@Around`, Metrics             |
| **权限控制** | 统一权限校验               | `@Before`, 自定义权限注解      |
| **缓存管理** | 方法结果缓存，缓存失效     | `@Around`, `@After`            |
| **参数校验** | 统一参数验证               | `@Before`                      |
| **重试机制** | 失败自动重试               | `@Around`, 自定义重试注解      |
| **限流熔断** | 流量控制，系统保护         | `@Around`                      |
| **数据脱敏** | 敏感信息保护               | `@AfterReturning`              |
| **版本控制** | API 版本管理               | `@Around`                      |



# jar中的类，有哪些方法增强该类

| 方法                  | 适用场景                 | 优点               | 缺点                |
| :-------------------- | :----------------------- | :----------------- | :------------------ |
| **ASM/Javassist**     | 编译时/构建时增强        | 性能最好，控制精细 | 需要字节码知识      |
| **Java Agent**        | 运行时增强，无需修改源码 | 无侵入，功能强大   | 需要启动参数        |
| **Byte Buddy**        | 运行时增强，API友好      | 简单易用，功能丰富 | 运行时开销          |
| **Spring AOP**        | Spring管理的Bean增强     | 集成Spring生态     | 只能增强Spring Bean |
| **AspectJ LTW**       | 加载时增强               | 功能最强大         | 配置复杂            |
| **自定义ClassLoader** | 类加载时增强             | 完全控制类加载     | 需要控制类加载过程  |